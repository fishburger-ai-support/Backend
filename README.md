# AI Support Backend

## –û–ø–∏—Å–∞–Ω–∏–µ

–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π backend –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤—Ö–æ–¥—è—â–∏—Ö –æ–±—Ä–∞—â–µ–Ω–∏–π —Å
–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º **GigaChat (Sber)** –∏ –±–∞–∑—ã –∑–Ω–∞–Ω–∏–π.

------------------------------------------------------------------------

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —Å–∏—Å—Ç–µ–º—ã

–°–∏—Å—Ç–µ–º–∞:

-   –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –ø–∏—Å—å–º–∞ —á–µ—Ä–µ–∑ webhook
-   –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∏—Ö —á–µ—Ä–µ–∑ AI
-   –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –æ–¥–Ω–æ –∏–∑ 3 —Ä–µ—à–µ–Ω–∏–π
-   —Å–æ–∑–¥–∞—ë—Ç —Ç–∏–∫–µ—Ç –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö

–î–∞–ª–µ–µ —Å–∏—Å—Ç–µ–º–∞ –º–æ–∂–µ—Ç:

-   ‚úÖ –æ—Ç–≤–µ—Ç–∏—Ç—å –∫–ª–∏–µ–Ω—Ç—É
-   ‚ùì –∑–∞–ø—Ä–æ—Å–∏—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
-   üö® —ç—Å–∫–∞–ª–∏—Ä–æ–≤–∞—Ç—å –æ–ø–µ—Ä–∞—Ç–æ—Ä—É (Telegram)

------------------------------------------------------------------------

## –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

-   FastAPI
-   SQLAlchemy (async)
-   SQLite / PostgreSQL
-   httpx (async)
-   Pydantic v2
-   GigaChat API
-   Telegram Bot API

------------------------------------------------------------------------

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

    ai-support/
    ‚îÇ
    ‚îú‚îÄ‚îÄ api/              # HTTP —Ä–æ—É—Ç—ã
    ‚îú‚îÄ‚îÄ services/         # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
    ‚îú‚îÄ‚îÄ models/           # ORM –º–æ–¥–µ–ª–∏
    ‚îú‚îÄ‚îÄ core/             # –ë–î, –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
    ‚îú‚îÄ‚îÄ config/           # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ (Pydantic Settings)
    ‚îú‚îÄ‚îÄ knowledge_base/   # –ü–æ–∏—Å–∫ –ø–æ –±–∞–∑–µ –∑–Ω–∞–Ω–∏–π
    ‚îÇ
    ‚îî‚îÄ‚îÄ main.py           # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞

------------------------------------------------------------------------

## –õ–æ–≥–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø–∏—Å—å–º–∞

–ü–∏—Å—å–º–æ –ø–æ—Å—Ç—É–ø–∞–µ—Ç –Ω–∞ endpoint:

    POST /api/webhook/email

AI –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –ø–∏—Å—å–º–æ –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç JSON —Å–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π:

``` json
{
  "full_name": "string",
  "issue_summary": "string",
  "decision": "full_answer | need_more_info | escalate_to_human",
  "draft_reply": "string"
}
```

### –í–æ–∑–º–æ–∂–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è (`decision`)

-   **full_answer** --- –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–æ—Ç–≤–µ—Ç –∫–ª–∏–µ–Ω—Ç—É\
-   **need_more_info** --- –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –∑–∞–ø—Ä–æ—Å —É—Ç–æ—á–Ω–µ–Ω–∏—è\
-   **escalate_to_human** --- –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –≤ Telegram

–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ —Ç–∏–∫–µ—Ç —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö.

------------------------------------------------------------------------

## –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (.env)

``` env
DATABASE_URL=sqlite+aiosqlite:///./test.db

GIGACHAT_AUTH_KEY=...
GIGACHAT_CLIENT_ID=...

TELEGRAM_BOT_TOKEN=...
TELEGRAM_CHAT_ID=...
```

------------------------------------------------------------------------

## –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

``` bash
pip install -r requirements.txt
```

### –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

``` bash
python main.py
```

–∏–ª–∏ —á–µ—Ä–µ–∑ uvicorn:

``` bash
uvicorn main:app --reload
```

------------------------------------------------------------------------

## –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏

### Swagger UI

    http://localhost:8000/docs

### Health-check

    GET /health
